# Implementation Plan for ADR-2026-01-16

## 1. Test Changes

### Component Tests

None required for this implementation (no UI components involved).

### Integration Tests

#### New Test Files

**`tests/domain/factories/ProjectFactory.test.ts`**

- **Purpose**: Unit test enhanced ProjectFactory merging logic
- **Pattern Reference**: [tests/domain/factories/](../../../tests/domain/factories/) (to be created), [ArticleFactory.ts](../../../src/core/domain/ArticleFactory.ts) for factory pattern
- **Key Scenarios**:
  - `fromGitHubRepositoryWithExtras()` with valid extra description â†’ merges title override, custom topics, complexity
  - `fromGitHubRepositoryWithExtras()` without extra description â†’ uses GitHub data with defaults
  - Missing critical data (no description in GitHub or extra) â†’ returns null and logs warning
  - Topic merging: GitHub topics + custom topics â†’ deduplicated array
  - Website URL priority: GitHub homepage > extra.websiteUrl > undefined
  - Defaults: complexity = MEDIUM, startsOpen = false when not provided
  - `fromGitHubRepositoriesWithExtras()` batch processing â†’ filters nulls correctly
  - Archived repository with `showEvenArchived = true` â†’ included
  - Archived repository without flag â†’ excluded
- **Test Data**: Use fixtures from `tests/fixtures/mockGitHubRepos.ts` and new `tests/fixtures/mockExtraDescriptions.ts`

**`tests/infrastructure/GitHubExtraDescriptionRepositoryRest.test.ts`**

- **Purpose**: Unit test GitHub Content API integration for fetching `.portfolio-description.json`
- **Pattern Reference**: [GitHubRepositoryRest.test.ts](../../../tests/infrastructure/GitHubRepositoryRest.test.ts), [NotionRepositoryRest.test.ts](../../../tests/infrastructure/NotionRepositoryRest.test.ts)
- **Key Scenarios**:
  - Fetch existing `.portfolio-description.json` â†’ returns ExtraPortfolioDescription entity
  - Fetch non-existent file (404) â†’ logs info, returns null (expected behavior)
  - Invalid JSON in file â†’ logs error, returns null gracefully
  - Schema validation failure (missing required fields) â†’ logs warning, returns null
  - GitHub API rate limit (403 with rate limit headers) â†’ logs warning with reset timestamp, returns null
  - Network error (500) â†’ logs error, returns null
  - Parallel fetching for multiple repos â†’ all settled, partial failures handled
  - Base64 decoding of GitHub Content API response â†’ correct JSON extraction
  - Authentication header included in all requests â†’ Bearer token present
- **Mocking Strategy**: Mock `fetch` API with MSW (Mock Service Worker) or `vi.fn()` for different response scenarios
- **Test Data**: Use new fixtures from `tests/fixtures/mockExtraDescriptions.ts`

**`tests/application-services/PublicWorkApplicationService.test.ts`** (UPDATE)

- **Purpose**: Integration test for orchestration with caching
- **Pattern Reference**: Existing [PublicWorkApplicationService.test.ts](../../../tests/application-services/PublicWorkApplicationService.test.ts)
- **New Scenarios to Add**:
  - Fetch projects with mix of extras (some repos have `.portfolio-description.json`, some don't) â†’ all projects returned with correct metadata
  - Cache hit scenario â†’ returns cached data, no GitHub API calls made (verify via spy)
  - Cache miss scenario â†’ fetches from GitHub, caches result, subsequent call hits cache
  - Cache TTL expiration â†’ after TTL expires, refetches data
  - Partial failure: extras fetch fails (rate limit) but repos succeed â†’ projects returned with GitHub data only, no errors
  - Complete failure: all fetches fail â†’ returns empty array, logs errors
  - Promise.allSettled usage â†’ partial failures don't break entire flow
  - Archived repo filtering with `showEvenArchived` flag â†’ correct inclusion/exclusion
- **Test Data**: Combine existing fixtures with new `mockExtraDescriptions.ts`

### End-to-End Tests

**`tests/e2e/public-work-display.spec.ts`** (NEW)

- **Purpose**: Validate happy-path SSR rendering of projects with enriched metadata
- **Framework**: Playwright
- **Pattern Reference**: Create new E2E test suite following Next.js best practices
- **Key Scenarios**:
  - Homepage renders projects section with enriched project cards (custom titles, complexity badges)
  - Project with extra description displays custom title (not GitHub repo name)
  - Complexity badge is visible and has correct ARIA label
  - External link icon for GitHub repo is present and accessible
  - Website URL link is present when provided
  - SSR hydration succeeds without mismatches
  - Page loads within performance budget (LCP < 2.5s)
- **Accessibility Validations**:
  - All project cards have semantic `<article>` wrappers
  - External links have appropriate ARIA labels
  - Keyboard navigation works (Tab through projects, Enter to open)
  - Sufficient color contrast on complexity badges (4.5:1 minimum)
- **Test Data**: Seed test GitHub repos with actual `.portfolio-description.json` files or mock API responses

---

## 2. Test Fixtures/Factories

### New Fixture Files

**`tests/fixtures/mockExtraDescriptions.ts`**

- **Purpose**: Provide mock ExtraPortfolioDescription entities for testing
- **Pattern Reference**: [mockGitHubRepos.ts](../../../tests/fixtures/mockGitHubRepos.ts), [mockArticles.ts](../../../tests/fixtures/mockArticles.ts)
- **Content Requirements**:
  - Export `mockExtraDescriptions: ExtraPortfolioDescription[]` array
  - Include scenarios:
    - Valid extra with all fields populated (repositoryId, title, customDescription, customTopics, websiteUrl, complexity: EXTREME, startsOpen: true, showEvenArchived: true)
    - Minimal extra with only required fields (repositoryId, title)
    - Extra with partial data (title + customDescription, no topics)
    - Extra with complexity variations (LOW, MEDIUM, HIGH, EXTREME)
  - Match `repositoryId` values to existing `mockGitHubRepos` for integration testing
  - Export `mockExtraDescriptionsMap: Map<string, ExtraPortfolioDescription>` for easy lookup by repositoryId

**`tests/fixtures/mockPortfolioDescriptionFiles.ts`** (NEW)

- **Purpose**: Mock raw `.portfolio-description.json` file contents (JSON strings) for GitHub Content API responses
- **Pattern Reference**: [mockNotionPages.ts](../../../tests/fixtures/mockNotionPages.ts)
- **Content Requirements**:
  - Export `mockPortfolioDescriptionFiles: { repositoryId: string; content: string }[]`
  - Include valid JSON strings (to be base64-encoded in tests)
  - Include invalid JSON string (malformed) for error testing
  - Include JSON with missing required fields for schema validation testing

### Updated Fixture Files

**`tests/fixtures/mockGitHubRepos.ts`** (UPDATE)

- **Changes**:
  - Add 2-3 new mock repositories with `archived: true` to test filtering
  - Ensure some repos have `description: null` to test fallback to `customDescription`
  - Ensure some repos have `homepage: null` and others with URLs to test website URL priority
  - Add variety in `topics` arrays to test merging with `customTopics`
- **Pattern Consistency**: Follow existing structure

**`tests/fixtures/index.ts`** (UPDATE)

- **Changes**: Export new fixtures (`mockExtraDescriptions`, `mockExtraDescriptionsMap`, `mockPortfolioDescriptionFiles`)

---

## 3. Implementation Phases

### Implementation Phase 1: Component and Integration Tests (TDD)

- **GOAL-001**: Implement Component and Integration Tests for domain layer enhancements
- **Impacted layers**: Domain (ProjectFactory), Infrastructure (GitHubExtraDescriptionRepositoryRest), Application Services (PublicWorkApplicationService)
- **Impacted files**:
  - `tests/domain/factories/ProjectFactory.test.ts` (NEW)
  - `tests/infrastructure/GitHubExtraDescriptionRepositoryRest.test.ts` (NEW)
  - `tests/application-services/PublicWorkApplicationService.test.ts` (UPDATE)
  - `tests/fixtures/mockExtraDescriptions.ts` (NEW)
  - `tests/fixtures/mockPortfolioDescriptionFiles.ts` (NEW)
  - `tests/fixtures/mockGitHubRepos.ts` (UPDATE)
  - `tests/fixtures/index.ts` (UPDATE)
- **Completion Criteria**:
  - All test files created with failing tests (RED phase)
  - Test fixtures provide comprehensive mock data
  - Tests cover all scenarios from ADR Section 5.6
  - CI pipeline runs tests successfully (even if failing)

### Implementation Phase 2: E2E Tests (TDD)

- **GOAL-002**: Implement End-to-End Tests for happy-path user flows
- **Impacted layers**: E2E (Playwright tests)
- **Impacted files**:
  - `tests/e2e/public-work-display.spec.ts` (NEW)
  - `playwright.config.ts` (UPDATE - if new config needed)
- **Completion Criteria**:
  - E2E test suite created with failing tests
  - Playwright configured for Next.js SSR testing
  - Accessibility validations included (ARIA, keyboard nav)
  - Performance assertions defined (LCP < 2.5s)

### Implementation Phase 3: Domain Layer Implementation

- **GOAL-003**: Implement domain entities, ports, and factory logic
- **Impacted layers**: Domain
- **Impacted files**:
  - `src/core/domain/Complexity.ts` (NEW)
  - `src/core/domain/ExtraPortfolioDescription.ts` (NEW)
  - `src/core/domain/ExtraPortfolioDescriptionRepository.ts` (NEW)
  - `src/core/domain/ExtraPortfolioDescriptionFactory.ts` (NEW)
  - `src/core/domain/Project.ts` (UPDATE)
  - `src/core/domain/ProjectFactory.ts` (UPDATE)
- **Completion Criteria**:
  - All domain tests pass (GREEN phase)
  - TypeScript compilation succeeds
  - No circular dependencies introduced
  - JSDoc comments added to all public interfaces/methods

### Implementation Phase 4: Infrastructure Layer Implementation

- **GOAL-004**: Implement GitHub Content API adapter with error handling
- **Impacted layers**: Infrastructure
- **Impacted files**:
  - `src/core/infrastructure/GitHubExtraDescriptionRepositoryRest.ts` (NEW)
  - `src/core/infrastructure/schemas/PortfolioDescriptionFileSchema.ts` (NEW)
  - `src/core/infrastructure/GitHubRepositoryRest.ts` (UPDATE - if archived filtering needed)
- **Completion Criteria**:
  - All infrastructure tests pass
  - Rate limit handling implemented (403 with silent failure)
  - Zod schema validation integrated (using a local shim fallback in CI/development when the `zod` package isn't installed; replace the shim with the real `zod` package when available)
  - Logging added for all error scenarios
  - Fetch requests include proper authentication headers

### Implementation Phase 5: Application Service Layer Implementation

- **GOAL-005**: Implement orchestration with in-memory caching
- **Impacted layers**: Application Services
- **Impacted files**:
  - `src/core/application-services/PublicWorkApplicationService.ts` (UPDATE)
- **Completion Criteria**:
  - All application service tests pass
  - Cache logic implemented (1-hour TTL)
  - Promise.allSettled used for parallel fetching
  - Extras matched with repos by repositoryId
  - Graceful degradation when extras fail

### Implementation Phase 6: Dependency Injection Configuration

- **GOAL-006**: Register new repository in InversifyJS container
- **Impacted layers**: Configuration
- **Impacted files**:
  - `src/core/ContainerConfig.ts` (UPDATE)
- **Completion Criteria**:
  - New repository bound to container
  - DI tokens exported correctly
  - Application service constructor updated
  - Container initialization succeeds
  - All integration tests pass with real DI

### Implementation Phase 7: E2E Test Validation

- **GOAL-007**: Validate E2E tests pass with full implementation
- **Impacted layers**: E2E
- **Impacted files**: None (validation phase)
- **Completion Criteria**:
  - All E2E tests pass
  - SSR hydration succeeds
  - Accessibility validations pass
  - Performance metrics meet targets (LCP < 2.5s)

### Implementation Phase 8: UI/UX Validation & Documentation

- **GOAL-008**: Final validation and documentation updates
- **Impacted layers**: Documentation
- **Impacted files**:
  - `README.md` (UPDATE - if needed)
  - `.ai/features/github-extra-descriptions/SCHEMA.md` (NEW)
- **Completion Criteria**:
  - All UI/UX validation items checked (see Section 8)
  - Documentation updated with `.portfolio-description.json` schema
  - Example file created in documentation
  - Code review completed

---

## 4. Data Layer Changes

### External API Integration: GitHub Content API

**Description**: Integrate GitHub Content API to fetch `.portfolio-description.json` files from repositories.

**Changes**:

#### New Infrastructure Adapter

**`src/core/infrastructure/GitHubExtraDescriptionRepositoryRest.ts`**

- **Purpose**: Implements `ExtraPortfolioDescriptionRepository` port
- **Endpoints Used**:
  - `GET https://api.github.com/user/repos` (fetch all repos)
  - `GET https://api.github.com/repos/{owner}/{repo}/contents/.portfolio-description.json` (fetch extras)
- **Request Schema**: No body, query params and path params only
- **Response Schema**: GitHub Content API response with base64-encoded JSON
- **Authentication**: Bearer token from `process.env.GITHUB_TOKEN`
- **Error Handling**:
  - 404 Not Found â†’ log info (debug), return null (expected)
  - 403 Rate Limit â†’ log warning with reset timestamp, return null (silent failure)
  - 401 Unauthorized â†’ log error, return null
  - 5xx Server Errors â†’ log error, return null
  - Invalid JSON â†’ log error, return null
  - Schema validation failure â†’ log warning, return null
- **Caching Strategy**: No caching at infrastructure layer (handled at application service level)
- **Retry Strategy**: None (fail fast to avoid cascading delays)

#### Data Validation Schema

**`src/core/infrastructure/schemas/PortfolioDescriptionFileSchema.ts`**

- **Purpose**: Zod schema for validating `.portfolio-description.json` file structure
- **Schema Definition**:
  ```typescript
  {
    repositoryId: string (required),
    title: string (required),
    description: string (optional),
    tags: string[] (optional),
    websiteUrl: string (optional, URL format),
    complexity: enum ['extreme', 'high', 'medium', 'low'] (optional),
    startsOpen: boolean (optional),
    showEvenArchived: boolean (optional)
  }
  ```
- **Validation Rules**: Use `z.object()`, `.optional()`, `.url()`, `.nativeEnum()`
- **Error Messages**: Include descriptive error messages for validation failures

#### Migration Procedures

None required (no database changes, external API only).

#### Rollback Strategy

If GitHub API integration fails catastrophically:

1. Application service cache provides 1-hour fallback with stale data
2. Silent failure ensures portfolio still renders with base GitHub data
3. Disable extra descriptions fetching via environment variable flag (`ENABLE_EXTRA_DESCRIPTIONS=false`)

---

## 5. Dependencies Changes

None required for this implementation. All necessary dependencies already exist:

- `inversify` (DI container) - already in use
- `zod` (schema validation) - planned. A local shim is used while the `zod` package is installed; once installed replace the shim with the real `zod` package and remove the fallback logic.
- Next.js 14 `fetch` API - native, no additional package needed
- TypeScript - already configured

---

## 6. Source Code Changes

### Overview

This implementation impacts the **Domain**, **Infrastructure**, and **Application Service** layers. No UI components are affected (server-side enhancement only).

**Code Execution Context**: All code runs on the server (Next.js Server Components, API routes, or SSR).

---

### 6.1 Pages/Routes

None required for this implementation (no new pages or routes).

---

### 6.2 Components

None required for this implementation (domain/infrastructure enhancement only, no UI changes).

---

### 6.3 API Routes & Server Actions

None required for this implementation (application service called directly in Server Components).

---

### 6.4 Services & Utilities

#### New Files

**`src/core/domain/ExtraPortfolioDescriptionFactory.ts`**

- **Purpose**: Factory for creating ExtraPortfolioDescription entities from raw file data
- **Execution Context**: Server-only
- **Function Signatures**:
  ```typescript
  class ExtraPortfolioDescriptionFactory {
    static fromFile(data: PortfolioDescriptionFile): ExtraPortfolioDescription;
  }
  ```
- **Implementation Details**:
  - Map `PortfolioDescriptionFile` (from Zod validation) to `ExtraPortfolioDescription` entity
  - Handle optional fields with defaults
  - No business logic (simple mapping)
- **Pattern Reference**: [ArticleFactory.ts](../../../src/core/domain/ArticleFactory.ts), [ProjectFactory.ts](../../../src/core/domain/ProjectFactory.ts)

#### Updated Files

**`src/core/domain/ProjectFactory.ts`** (UPDATE)

- **Purpose**: Add merging logic for GitHub repos + extra descriptions
- **Execution Context**: Server-only
- **New Methods**:

  ```typescript
  class ProjectFactory {
    static fromGitHubRepositoryWithExtras(
      repo: GitHubCodeRepository,
      extra?: ExtraPortfolioDescription | null
    ): Project | null;

    static fromGitHubRepositoriesWithExtras(
      repos: GitHubCodeRepository[],
      extrasMap: Map<string, ExtraPortfolioDescription | null>
    ): Project[];
  }
  ```

- **Implementation Details**:
  - **Title Priority**: `extra.title` > `repo.name`
  - **Description Priority**: `repo.description` > `extra.customDescription` (if repo.description is null/empty)
  - **Website URL Priority**: `repo.homepage` > `extra.websiteUrl`
  - **Topics Merging**: Deduplicate `repo.topics` + `extra.customTopics`
  - **Defaults**: `complexity = Complexity.MEDIUM`, `startsOpen = false`
  - **Skip Logic**: Return `null` if no valid description found, log warning
  - **Archived Filtering**: Skip archived repos unless `extra.showEvenArchived = true`
- **Pattern Reference**: Existing `fromGitHubRepository()` method, [ArticleFactory.ts](../../../src/core/domain/ArticleFactory.ts) filtering pattern

**`src/core/application-services/PublicWorkApplicationService.ts`** (UPDATE)

- **Purpose**: Orchestrate fetching with in-memory caching
- **Execution Context**: Server-only
- **Changes**:
  - Add in-memory cache with 1-hour TTL (`cache: CacheEntry | null`, `CACHE_TTL_MS`)
  - Update `getAll()` method:
    1. Check cache, return if valid
    2. Fetch repos and extras in parallel with `Promise.allSettled`
    3. Match extras with repos by `repositoryId` (create Map)
    4. Call `ProjectFactory.fromGitHubRepositoriesWithExtras(repos, extrasMap)`
    5. Merge with articles and certifications
    6. Cache result with timestamp
    7. Return PublicWorkItem[]
  - Log cache hits/misses
  - Log partial failures (rate limits, errors)
- **Caching Details**:
  - Cache key: Single cache entry (no parameterization needed)
  - Cache invalidation: Time-based only (no manual invalidation)
  - Environment variable: `PUBLIC_WORK_CACHE_TTL_MS` (default: 3600000 = 1 hour)
- **Pattern Reference**: Existing `getAll()` method structure

**`src/core/infrastructure/GitHubExtraDescriptionRepositoryRest.ts`** (NEW)

- **Purpose**: Fetch `.portfolio-description.json` files from GitHub Content API
- **Execution Context**: Server-only
- **Implementation Details**: See Section 4 (Data Layer Changes)
- **Pattern Reference**: [GitHubRepositoryRest.ts](../../../src/core/infrastructure/GitHubRepositoryRest.ts), [NotionRepositoryRest.ts](../../../src/core/infrastructure/NotionRepositoryRest.ts)

---

### 6.5 Types & Schemas

#### New Files

**`src/core/domain/Complexity.ts`**

- **Purpose**: Enum for project complexity/difficulty ratings
- **Content**:

  ```typescript
  export enum Complexity {
    EXTREME = 'extreme',
    HIGH = 'high',
    MEDIUM = 'medium',
    LOW = 'low',
  }

  export const ComplexityLabels: Record<Complexity, string> = {
    [Complexity.EXTREME]: 'Extreme',
    [Complexity.HIGH]: 'High',
    [Complexity.MEDIUM]: 'Medium',
    [Complexity.LOW]: 'Low',
  };
  ```

- **Shared**: Server and client (if complexity badges are added to UI later)

**`src/core/domain/ExtraPortfolioDescription.ts`**

- **Purpose**: Entity representing custom project metadata from `.portfolio-description.json`
- **Content**:

  ```typescript
  import { Complexity } from './Complexity';

  export interface ExtraPortfolioDescription {
    repositoryId: string;
    title: string;
    customDescription?: string;
    customTopics?: string[];
    websiteUrl?: string;
    complexity?: Complexity;
    startsOpen?: boolean;
    showEvenArchived?: boolean;
  }
  ```

- **Shared**: Server-only (domain entity)

**`src/core/domain/ExtraPortfolioDescriptionRepository.ts`**

- **Purpose**: Port (interface) for fetching extra descriptions
- **Content**:

  ```typescript
  import { ExtraPortfolioDescription } from './ExtraPortfolioDescription';

  export type ExtraDescriptionsMap = Map<string, ExtraPortfolioDescription | null>;

  export interface ExtraPortfolioDescriptionRepository {
    fetchExtraDescriptions(): Promise<ExtraDescriptionsMap>;
  }

  export const ExtraPortfolioDescriptionRepositoryToken = Symbol.for(
    'ExtraPortfolioDescriptionRepository'
  );
  ```

- **Shared**: Server-only (domain port)

**`src/core/infrastructure/schemas/PortfolioDescriptionFileSchema.ts`**

- **Purpose**: Zod schema for validating `.portfolio-description.json` files
- **Content**: See Section 4 (Data Layer Changes)
- **Shared**: Server-only (infrastructure)

#### Updated Files

**`src/core/domain/Project.ts`** (UPDATE)

- **Changes**: Add optional fields

  ```typescript
  import { Complexity } from './Complexity';

  export interface Project {
    // ... existing fields
    websiteUrl?: string; // NEW
    complexity?: Complexity; // NEW
    startsOpen?: boolean; // NEW
  }
  ```

- **Shared**: Server and client (domain entity)

---

### 6.6 Styles & Assets

None required for this implementation (no UI changes).

---

### 6.7 Configuration

#### Updated Files

**`src/core/ContainerConfig.ts`** (UPDATE)

- **Changes**:
  - Import new repository interface and implementation
  - Bind `ExtraPortfolioDescriptionRepository` to `GitHubExtraDescriptionRepositoryRest`
  - Update `PublicWorkApplicationService` constructor injection
- **Example**:

  ```typescript
  import { ExtraPortfolioDescriptionRepositoryToken } from '@/core/domain/ExtraPortfolioDescriptionRepository';
  import { GitHubExtraDescriptionRepositoryRest } from '@/core/infrastructure/GitHubExtraDescriptionRepositoryRest';

  container
    .bind(ExtraPortfolioDescriptionRepositoryToken)
    .to(GitHubExtraDescriptionRepositoryRest)
    .inSingletonScope();
  ```

- **Impact**: DI container initialization, affects application startup

**`.env.example`** (UPDATE - if needed)

- **Changes**: Add new environment variables

  ```
  # GitHub API token for authenticated requests (5000 requests/hour)
  GITHUB_TOKEN=your_github_personal_access_token_here

  # Optional: Cache TTL for PublicWorkApplicationService (milliseconds)
  # Default: 3600000 (1 hour)
  PUBLIC_WORK_CACHE_TTL_MS=3600000

  # Optional: Enable/disable extra descriptions fetching (for emergency rollback)
  # Default: true
  ENABLE_EXTRA_DESCRIPTIONS=true
  ```

- **Purpose**: Document new configuration options for developers

---

## 7. Documentation Changes

### New Documentation Files

**`.ai/features/github-extra-descriptions/SCHEMA.md`**

- **Purpose**: Document `.portfolio-description.json` file schema for repository maintainers
- **Content**:
  - Schema definition (JSON structure)
  - Field descriptions and constraints
  - Examples (minimal, full, complex scenarios)
  - Validation rules
  - Best practices (when to use custom descriptions, complexity ratings guide)
  - Troubleshooting (schema validation errors, 404 handling)
- **Pattern Reference**: Create structured markdown with code blocks and tables

**`.ai/features/github-extra-descriptions/EXAMPLE.portfolio-description.json`**

- **Purpose**: Provide copy-paste template for developers
- **Content**: Fully populated example with all optional fields, inline comments
- **Pattern Reference**: Standard JSON file with JSDoc-style comments

### Updated Documentation Files

**`README.md`** (UPDATE - Section: "Project Structure")

- **Changes**:
  - Add bullet point explaining `ExtraPortfolioDescription` domain entity
  - Add bullet point explaining GitHub Content API integration
  - Link to `.ai/features/github-extra-descriptions/SCHEMA.md`
- **Pattern Reference**: Existing README structure

**`.ai/features/github-extra-descriptions/ADR-2026-01-16.md`** (UPDATE - Section 10: Approval & Sign-off)

- **Changes**: Update status from "ðŸŸ¡ Proposed" to "âœ… Approved" after implementation
- **Date**: Add implementation completion date

---

## 8. UI/UX Validation

### Accessibility Validation

None required for this implementation phase (domain/infrastructure enhancement only).

**Future Work** (when UI components are added):

- Complexity badges must have ARIA labels (`aria-label="Complexity: High"`)
- Ensure sufficient color contrast for badges (4.5:1 minimum)
- Keyboard navigation for project cards (Tab, Enter)
- Screen reader testing (VoiceOver, NVDA)

### Responsive Design Validation

None required for this implementation (no UI changes).

### Performance Metrics Validation

#### Server-Side Performance

**Metrics to Validate**:

- **Fetch Latency** (Cache Miss):
  - Target: < 2 seconds for 30 repositories + extras
  - Measurement: Log timestamps in `PublicWorkApplicationService.getAll()`
  - Tool: Next.js Server Timing API or console timestamps
- **Fetch Latency** (Cache Hit):
  - Target: < 50ms
  - Measurement: Log cache hit latency
- **Cache Hit Rate**:
  - Target: > 90% (with 1-hour TTL and typical traffic patterns)
  - Measurement: Log cache hits vs misses over 24-hour period
- **Error Rate**:
  - Target: < 5% (excluding expected 404s for missing `.portfolio-description.json`)
  - Measurement: Log errors, calculate percentage
- **GitHub API Rate Limit Impact**:
  - Target: Zero user-facing errors
  - Measurement: Monitor rate limit warnings in logs, ensure silent failures work

**Validation Steps**:

1. Deploy to staging environment
2. Trigger 10 consecutive page loads within 1 hour (verify cache hits)
3. Wait for cache expiration, trigger reload (verify cache miss + refetch)
4. Simulate rate limit by hitting GitHub API limit (verify silent failure)
5. Monitor logs for errors, latency spikes, cache hit/miss ratio

#### Core Web Vitals (SSR Pages)

**Metrics to Validate** (when projects are rendered in UI):

- **LCP (Largest Contentful Paint)**: < 2.5s (no change expected, server-side enhancement)
- **FID (First Input Delay)**: < 100ms (no change expected)
- **CLS (Cumulative Layout Shift)**: < 0.1 (no change expected)

**Measurement**: Use Lighthouse, WebPageTest, or Chrome DevTools Performance tab.

### Cross-Browser Testing

None required for this implementation (server-side only).

---

## 9. Risks & Assumptions

### Risks

- **RISK-001**: GitHub API rate limits during high traffic periods

  - **Impact**: HIGH - Users see incomplete project list if rate limit hit repeatedly
  - **Probability**: MEDIUM (with caching, probability reduced to LOW)
  - **Mitigation**:
    - In-memory cache (1-hour TTL) reduces API calls by 95%
    - Silent failure ensures portfolio always renders (graceful degradation)
    - Use authenticated GitHub token (5000 requests/hour vs 60 unauthenticated)
    - Monitor rate limit warnings in logs for proactive adjustments
    - Add environment variable flag (`ENABLE_EXTRA_DESCRIPTIONS`) for emergency rollback

- **RISK-002**: Invalid `.portfolio-description.json` schema in repositories

  - **Impact**: MEDIUM - Specific projects skipped, no user-facing errors
  - **Probability**: LOW (with Zod validation or local shim and clear schema documentation)
  - **Mitigation**:
    - Zod schema validation catches issues early
    - Detailed logging with schema validation errors (include repository name)
    - Fallback to GitHub data if extra is invalid
    - Document schema clearly in `.ai/features/github-extra-descriptions/SCHEMA.md`
    - Consider adding pre-commit hook or CI validation for `.portfolio-description.json` files

- **RISK-003**: Network latency for GitHub Content API calls

  - **Impact**: MEDIUM - Slower page loads on cache misses (1-2s additional latency)
  - **Probability**: MEDIUM (network-dependent)
  - **Mitigation**:
    - Parallel fetching with `Promise.allSettled` minimizes sequential delays
    - Cache hit rate > 90% means most users see <50ms latency
    - Next.js ISR provides 24-hour page-level fallback
    - Set reasonable timeout on fetch requests (10s) to avoid hanging

- **RISK-004**: Cache invalidation issues

  - **Impact**: LOW - Users see stale project metadata for up to 1 hour
  - **Probability**: LOW (acceptable trade-off for performance)
  - **Mitigation**:
    - 1-hour TTL balances freshness vs performance
    - Manual cache clear not implemented initially (can add webhook endpoint later)
    - Document cache behavior clearly for stakeholders

- **RISK-005**: Dependency on external GitHub API availability

  - **Impact**: MEDIUM - Portfolio renders with incomplete data if GitHub is down
  - **Probability**: LOW (GitHub uptime > 99.9%)
  - **Mitigation**:
    - Silent failure ensures portfolio always renders
    - Application service cache provides 1-hour fallback with stale data
    - Next.js ISR adds 24-hour page-level fallback
    - Log errors for monitoring/alerting

- **RISK-006**: Increased server-side execution time affecting SSR performance
  - **Impact**: MEDIUM - Slower Time to First Byte (TTFB) on cache misses
  - **Probability**: LOW (with aggressive caching)
  - **Mitigation**:
    - Cache hit rate > 90% minimizes impact
    - Consider moving to ISR (Incremental Static Regeneration) for homepage if TTFB becomes issue
    - Monitor Server Timing API metrics

### Assumptions

- **ASSUMPTION-001**: GitHub Personal Access Token has sufficient rate limits (5000 requests/hour)

  - **Validation**: Verify token permissions in GitHub settings
  - **Impact if false**: Frequent rate limit errors, degraded user experience
  - **Contingency**: Use GitHub App installation token (higher limits) or implement more aggressive caching

- **ASSUMPTION-002**: `.portfolio-description.json` files will remain consistent in schema structure

  - **Validation**: Document schema clearly, encourage versioning later if needed
  - **Impact if false**: Frequent schema validation failures, projects skipped
  - **Contingency**: Add `schemaVersion` field, support multiple schema versions with migration logic

- **ASSUMPTION-003**: Most repositories (>80%) will NOT have `.portfolio-description.json` files

  - **Validation**: Monitor 404 rate in logs
  - **Impact if false**: Higher API call volume, negligible (404s are fast)
  - **Contingency**: None needed (expected behavior)

- **ASSUMPTION-004**: Application service caching is sufficient for traffic patterns (no Redis/external cache needed)

  - **Validation**: Monitor cache hit rate and server memory usage in production
  - **Impact if false**: High memory usage, potential memory leaks
  - **Contingency**: Migrate to Redis or similar external cache, implement LRU eviction

- **ASSUMPTION-005**: GitHub API will maintain backward compatibility for Content API

  - **Validation**: Use versioned API endpoints (`X-GitHub-Api-Version: 2022-11-28`)
  - **Impact if false**: Fetch failures, breaking changes
  - **Contingency**: Monitor GitHub API changelog, add integration tests for API responses

- **ASSUMPTION-006**: Server environment supports `fetch` API (Node.js 18+)

  - **Validation**: Verify Next.js 14 runtime requirements (Node.js 18.17+)
  - **Impact if false**: Runtime errors on fetch calls
  - **Contingency**: Polyfill `fetch` if needed (unlikely with Next.js 14)

- **ASSUMPTION-007**: No more than 100 repositories per GitHub account

  - **Validation**: Check current repo count, assume growth <100
  - **Impact if false**: Pagination needed for GitHub API calls
  - **Contingency**: Implement pagination in `GitHubExtraDescriptionRepositoryRest` (fetch all pages until empty)

- **ASSUMPTION-008**: Complexity ratings are subjective and manually maintained by developer
  - **Validation**: Document complexity rating guidelines in SCHEMA.md
  - **Impact if false**: Inconsistent ratings, confusing for users
  - **Contingency**: Add automated complexity scoring based on repo metrics (stars, language, size) - future enhancement

---

## 10. Sign-off

**Implementation Plan Status**: âœ… Ready for Execution

**Next Steps**:

1. Review implementation plan with stakeholders
2. Assign phases to AI Agent or developer
3. Begin Phase 1 (TDD - Component and Integration Tests)
4. Execute phases sequentially, validating completion criteria at each step
5. Install `zod` and replace the local schema shim with the real `zod` package; run `npm install zod` and re-run tests to ensure full Zod-based validation is in place
6. Final review after Phase 8 (UI/UX Validation & Documentation)

**Estimated Effort**:

- Phase 1 (TDD - Tests): 4-6 hours
- Phase 2 (TDD - E2E Tests): 2-3 hours
- Phase 3 (Domain Layer): 2-3 hours
- Phase 4 (Infrastructure Layer): 3-4 hours
- Phase 5 (Application Service): 2-3 hours
- Phase 6 (DI Configuration): 1 hour
- Phase 7 (E2E Validation): 1 hour
- Phase 8 (Documentation): 2 hours
- **Total**: 17-25 hours

**Dependencies**:

- GitHub Personal Access Token with `repo` scope (for Content API access)
- Node.js 18.17+ (Next.js 14 requirement)
- Existing test infrastructure (Vitest, Playwright)

---

_This implementation plan was generated following the template from `.github/prompts/writeImplementationPlan.prompt.md` and aligns with ADR-2026-01-16._
